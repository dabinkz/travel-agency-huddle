<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Agency Daily Sales Huddle</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .date-display {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 30px;
        }
        
        .huddle-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #3498db;
        }
        
        .form-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .team-member {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #e1e8ed;
        }
        
        .member-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .member-name {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .remove-member {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .add-member-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }
        
        .data-display {
            margin-top: 30px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .data-table th {
            background: #3498db;
            color: white;
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background: #f5f5f5;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .huddle-form {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç Travel Agency Daily Sales Huddle</h1>
            <div class="date-display" id="currentDate"></div>
        </div>
        
        <div class="main-content">
            <form id="huddleForm" class="huddle-form">
                <div class="form-section">
                    <h3>üéØ Daily Goals & Targets</h3>
                    <div class="form-group">
                        <label>Team Sales Target ($)</label>
                        <input type="number" id="salesTarget" placeholder="e.g., 15000" required>
                    </div>
                    <div class="form-group">
                        <label>Bookings Target</label>
                        <input type="number" id="bookingsTarget" placeholder="e.g., 25" required>
                    </div>
                    <div class="form-group">
                        <label>Leads Target</label>
                        <input type="number" id="leadsTarget" placeholder="e.g., 50" required>
                    </div>
                    <div class="form-group">
                        <label>Focus Destination</label>
                        <input type="text" id="focusDestination" placeholder="e.g., Bali, Europe, Dubai" required>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>‚ö†Ô∏è Current Challenges</h3>
                    <div class="form-group">
                        <label>Main Problem/Challenge</label>
                        <textarea id="mainProblem" placeholder="Describe the main challenge the team is facing today..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Priority Level</label>
                        <select id="priorityLevel" required>
                            <option value="">Select Priority</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Proposed Solution</label>
                        <textarea id="proposedSolution" placeholder="What actions will be taken to address this challenge?"></textarea>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>üí° Daily Tips & Insights</h3>
                    <div class="form-group">
                        <label>Sales Tip of the Day</label>
                        <textarea id="salesTip" placeholder="Share a valuable sales tip or strategy..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Market Insight</label>
                        <textarea id="marketInsight" placeholder="Any market trends or customer insights to share..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Success Story</label>
                        <textarea id="successStory" placeholder="Share a recent win or success story..."></textarea>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>üë• Team Performance</h3>
                    <div id="teamMembers">
                        <div class="team-member">
                            <div class="member-header">
                                <span class="member-name">Team Member 1</span>
                                <button type="button" class="remove-member" onclick="removeMember(this)">Remove</button>
                            </div>
                            <div class="form-group">
                                <label>Name</label>
                                <input type="text" name="memberName" placeholder="Agent name" required>
                            </div>
                            <div class="form-group">
                                <label>Individual Target ($)</label>
                                <input type="number" name="memberTarget" placeholder="e.g., 3000">
                            </div>
                            <div class="form-group">
                                <label>Current Performance ($)</label>
                                <input type="number" name="memberPerformance" placeholder="e.g., 2500">
                            </div>
                            <div class="form-group">
                                <label>Notes</label>
                                <input type="text" name="memberNotes" placeholder="Performance notes or comments">
                            </div>
                        </div>
                    </div>
                    <button type="button" class="add-member-btn" onclick="addTeamMember()">+ Add Team Member</button>
                </div>
            </form>
            
            <div class="action-buttons">
                <button type="button" class="btn btn-primary" onclick="saveHuddle()">üíæ Save Today's Huddle</button>
                <button type="button" class="btn btn-success" onclick="exportToExcel()">üìä Export to Excel</button>
                <button type="button" class="btn btn-info" onclick="viewHistory()">üìà View History</button>
                <button type="button" class="btn btn-warning" onclick="clearForm()">üîÑ Clear Form</button>
            </div>
            
            <div class="data-display" id="dataDisplay" style="display: none;">
                <h3>üìä Huddle History & Analytics</h3>
                <div class="stats-grid" id="statsGrid"></div>
                <table class="data-table" id="historyTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Sales Target</th>
                            <th>Bookings Target</th>
                            <th>Main Challenge</th>
                            <th>Focus Destination</th>
                            <th>Team Size</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentDate();
            loadSavedData();
        });

        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', options);
        }

        function addTeamMember() {
            const teamMembers = document.getElementById('teamMembers');
            const memberCount = teamMembers.children.length;
            
            const memberDiv = document.createElement('div');
            memberDiv.className = 'team-member';
            memberDiv.innerHTML = `
                <div class="member-header">
                    <span class="member-name">Team Member ${memberCount + 1}</span>
                    <button type="button" class="remove-member" onclick="removeMember(this)">Remove</button>
                </div>
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" name="memberName" placeholder="Agent name" required>
                </div>
                <div class="form-group">
                    <label>Individual Target ($)</label>
                    <input type="number" name="memberTarget" placeholder="e.g., 3000">
                </div>
                <div class="form-group">
                    <label>Current Performance ($)</label>
                    <input type="number" name="memberPerformance" placeholder="e.g., 2500">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <input type="text" name="memberNotes" placeholder="Performance notes or comments">
                </div>
            `;
            
            teamMembers.appendChild(memberDiv);
        }

        function removeMember(button) {
            const teamMembers = document.getElementById('teamMembers');
            if (teamMembers.children.length > 1) {
                button.closest('.team-member').remove();
                updateMemberNumbers();
            } else {
                alert('You must have at least one team member!');
            }
        }

        function updateMemberNumbers() {
            const members = document.querySelectorAll('.team-member');
            members.forEach((member, index) => {
                member.querySelector('.member-name').textContent = `Team Member ${index + 1}`;
            });
        }

        function saveHuddle() {
            const formData = collectFormData();
            if (!formData) return;

            // Get existing data
            let savedData = JSON.parse(localStorage.getItem('huddleData') || '[]');
            
            // Add new entry
            savedData.push(formData);
            
            // Save to localStorage
            localStorage.setItem('huddleData', JSON.stringify(savedData));
            
            alert('‚úÖ Huddle data saved successfully!');
            clearForm();
        }

        function collectFormData() {
            // Validate required fields
            const requiredFields = ['salesTarget', 'bookingsTarget', 'leadsTarget', 'focusDestination', 'mainProblem', 'priorityLevel', 'salesTip'];
            for (let field of requiredFields) {
                if (!document.getElementById(field).value.trim()) {
                    alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()} field.`);
                    return null;
                }
            }

            // Collect team member data
            const teamMembers = [];
            const memberDivs = document.querySelectorAll('.team-member');
            
            for (let memberDiv of memberDivs) {
                const name = memberDiv.querySelector('input[name="memberName"]').value;
                if (!name.trim()) {
                    alert('Please fill in all team member names.');
                    return null;
                }
                
                teamMembers.push({
                    name: name,
                    target: parseFloat(memberDiv.querySelector('input[name="memberTarget"]').value) || 0,
                    performance: parseFloat(memberDiv.querySelector('input[name="memberPerformance"]').value) || 0,
                    notes: memberDiv.querySelector('input[name="memberNotes"]').value
                });
            }

            return {
                date: new Date().toISOString().split('T')[0],
                timestamp: new Date().toISOString(),
                salesTarget: parseFloat(document.getElementById('salesTarget').value),
                bookingsTarget: parseInt(document.getElementById('bookingsTarget').value),
                leadsTarget: parseInt(document.getElementById('leadsTarget').value),
                focusDestination: document.getElementById('focusDestination').value,
                mainProblem: document.getElementById('mainProblem').value,
                priorityLevel: document.getElementById('priorityLevel').value,
                proposedSolution: document.getElementById('proposedSolution').value,
                salesTip: document.getElementById('salesTip').value,
                marketInsight: document.getElementById('marketInsight').value,
                successStory: document.getElementById('successStory').value,
                teamMembers: teamMembers
            };
        }

        function exportToExcel() {
            const savedData = JSON.parse(localStorage.getItem('huddleData') || '[]');
            
            if (savedData.length === 0) {
                alert('No data to export. Please save some huddle data first.');
                return;
            }

            // Prepare data for Excel
            const excelData = [];
            
            savedData.forEach(huddle => {
                // Main huddle data
                const baseRow = {
                    'Date': huddle.date,
                    'Sales Target': huddle.salesTarget,
                    'Bookings Target': huddle.bookingsTarget,
                    'Leads Target': huddle.leadsTarget,
                    'Focus Destination': huddle.focusDestination,
                    'Main Problem': huddle.mainProblem,
                    'Priority Level': huddle.priorityLevel,
                    'Proposed Solution': huddle.proposedSolution,
                    'Sales Tip': huddle.salesTip,
                    'Market Insight': huddle.marketInsight,
                    'Success Story': huddle.successStory,
                    'Team Size': huddle.teamMembers.length
                };

                // Add team member data
                if (huddle.teamMembers.length > 0) {
                    huddle.teamMembers.forEach((member, index) => {
                        const row = { ...baseRow };
                        row['Member Name'] = member.name;
                        row['Member Target'] = member.target;
                        row['Member Performance'] = member.performance;
                        row['Member Notes'] = member.notes;
                        row['Performance %'] = member.target > 0 ? Math.round((member.performance / member.target) * 100) : 0;
                        excelData.push(row);
                    });
                } else {
                    excelData.push(baseRow);
                }
            });

            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            // Auto-size columns
            const colWidths = [];
            const headers = Object.keys(excelData[0] || {});
            headers.forEach(header => {
                const maxLength = Math.max(
                    header.length,
                    ...excelData.map(row => String(row[header] || '').length)
                );
                colWidths.push({ width: Math.min(maxLength + 2, 50) });
            });
            ws['!cols'] = colWidths;

            XLSX.utils.book_append_sheet(wb, ws, "Daily Huddles");
            
            // Generate filename with current date
            const filename = `Travel_Agency_Huddles_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
            
            alert('üìä Excel file exported successfully!');
        }

        function viewHistory() {
            const savedData = JSON.parse(localStorage.getItem('huddleData') || '[]');
            const dataDisplay = document.getElementById('dataDisplay');
            const historyTableBody = document.getElementById('historyTableBody');
            const statsGrid = document.getElementById('statsGrid');
            
            if (savedData.length === 0) {
                alert('No huddle history found. Save some data first!');
                return;
            }

            // Calculate statistics
            const totalHuddles = savedData.length;
            const avgSalesTarget = savedData.reduce((sum, h) => sum + h.salesTarget, 0) / totalHuddles;
            const avgBookingsTarget = savedData.reduce((sum, h) => sum + h.bookingsTarget, 0) / totalHuddles;
            const totalTeamMembers = savedData.reduce((sum, h) => sum + h.teamMembers.length, 0);

            // Update stats grid
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalHuddles}</div>
                    <div class="stat-label">Total Huddles</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">$${Math.round(avgSalesTarget).toLocaleString()}</div>
                    <div class="stat-label">Avg Sales Target</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${Math.round(avgBookingsTarget)}</div>
                    <div class="stat-label">Avg Bookings Target</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${totalTeamMembers}</div>
                    <div class="stat-label">Total Team Entries</div>
                </div>
            `;

            // Update history table
            historyTableBody.innerHTML = savedData.map((huddle, index) => `
                <tr>
                    <td>${new Date(huddle.date).toLocaleDateString()}</td>
                    <td>$${huddle.salesTarget.toLocaleString()}</td>
                    <td>${huddle.bookingsTarget}</td>
                    <td>${huddle.mainProblem.substring(0, 50)}${huddle.mainProblem.length > 50 ? '...' : ''}</td>
                    <td>${huddle.focusDestination}</td>
                    <td>${huddle.teamMembers.length}</td>
                    <td>
                        <button onclick="deleteHuddle(${index})" style="background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Delete</button>
                    </td>
                </tr>
            `).join('');

            dataDisplay.style.display = 'block';
            dataDisplay.scrollIntoView({ behavior: 'smooth' });
        }

        function deleteHuddle(index) {
            if (confirm('Are you sure you want to delete this huddle entry?')) {
                let savedData = JSON.parse(localStorage.getItem('huddleData') || '[]');
                savedData.splice(index, 1);
                localStorage.setItem('huddleData', JSON.stringify(savedData));
                viewHistory(); // Refresh the display
                alert('Huddle entry deleted successfully!');
            }
        }

        function clearForm() {
            document.getElementById('huddleForm').reset();
            
            // Reset team members to just one
            const teamMembers = document.getElementById('teamMembers');
            teamMembers.innerHTML = `
                <div class="team-member">
                    <div class="member-header">
                        <span class="member-name">Team Member 1</span>
                        <button type="button" class="remove-member" onclick="removeMember(this)">Remove</button>
                    </div>
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" name="memberName" placeholder="Agent name" required>
                    </div>
                    <div class="form-group">
                        <label>Individual Target ($)</label>
                        <input type="number" name="memberTarget" placeholder="e.g., 3000">
                    </div>
                    <div class="form-group">
                        <label>Current Performance ($)</label>
                        <input type="number" name="memberPerformance" placeholder="e.g., 2500">
                    </div>
                    <div class="form-group">
                        <label>Notes</label>
                        <input type="text" name="memberNotes" placeholder="Performance notes or comments">
                    </div>
                </div>
            `;
            
            // Hide data display
            document.getElementById('dataDisplay').style.display = 'none';
        }

        function loadSavedData() {
            // This function can be used to load and display recent data if needed
            const savedData = JSON.parse(localStorage.getItem('huddleData') || '[]');
            console.log(`Loaded ${savedData.length} previous huddle entries`);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'980e05fd209213e3',t:'MTc1ODE2ODkzOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
